---
tags:
  - Java/ПодКапотом
  - "#java/pool"
aliases:
  - Пулы в Java
  - pools
---
[[Pools Overview|что такое pool?]]
![[Пример пула интов.png]]
В Java есть пул (pool) целых чисел в промежутке [-128;127]. Т.е. если мы создаем Integer в этом промежутке, то вместо того, чтобы каждый раз создавать новый объект, JVM берет их из пула. Таким образом, в первом примере i1 и i2 указывают на один и тот же объект из пула, а во втором - создаются два разных объекта. Отсюда и результат.

**Как увеличить верхнюю границу пула интов?**
[Вы можете изменить это значение с помощью параметра системы java.lang.Integer.IntegerCache.high при запуске JVM](https://stackoverflow.com/questions/13098143/why-does-the-behavior-of-the-integer-constant-pool-change-at-127).
Например
```sh
-Djava.lang.Integer.IntegerCache.high=256. 
```

Это должно увеличить верхнюю границу пула целых чисел до 256. Это нужно, если в приложении часто происходят операции с небольшими числами, но нужно быть внимательным, т.к. кэширование влияет на производительность

## Кэширование или Integer pool

![[Автоупаковка int пояснение.png]]
В классе-обёртке Integer есть внутренний класс **IntegerCache**. Он объявлен как private static. В этом внутреннем классе кешированные объекты находятся в массиве cache[].

Кеширование выполняется **при первом использовании класса-обёртки**. После первого использования, вместо создания нового экземпляра (кроме использования конструктора), используются кешированные объекты.

Код метода valueOf() класса Integer выгдядит так:
![[Код метода valueOf класса Integer.png]]
**Справка**: Кэширование касается не только класса-оболочки Integer. Имеются аналогичные реализации кеширования для других классов-оболочек целочисленных типов: ByteCache, ShortCache, LongCache, CharacterCache.

Кешированные объекты не используются при создании объекта-обёртки с помощью конструктора.

бывает пул boolean(-ов)? Ответ: да, только в пуле две константы **true** и **false**.

>[!Info]
>**Вопрос:** Чем отличаются пул и кэширование в Java?
>**Ответ:** Пул — это коллекция объектов, которые переиспользуются и имеют ограниченное количество элементов, которые берутся и возвращаются обратно. Кэширование же сохраняет часто используемые данные для быстрого доступа, не имея фиксированного размера. Например, пул целых чисел в Java использует кэширование, но это всё равно пул, потому что количество объектов ограничено.