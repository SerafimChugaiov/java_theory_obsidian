---
tags:
  - Java/Исключения
aliases:
  - Стек трейс
---
## Что такое стек трейс?
Stack trace — это сообщение об ошибке, которое показывает цепочку вызовов методов, приведших к исключению (exception). Это основной инструмент отладки программ в Java.
Когда возникает исключение, JVM формирует стек трейс, который позволяет понять:
- где именно произошла ошибка;
- что к ней привело;
- какой тип ошибки возник.
## Структура стек трейса

Каждая строка стек трейса отражает вызов метода и имеет формат:

```
at [полное имя класса].[имя метода]([ИмяФайла].java:[номер строки])
```

Пример:
```
Exception in thread "main" java.lang.NullPointerException
	at com.example.service.UserService.getUser(UserService.java:45)
	at com.example.controller.UserController.handle(UserController.java:22)
	at com.example.Main.main(Main.java:10)
```

Разбор:
- "Exception in thread" — поток, в котором произошло исключение.
- "java.lang.NullPointerException" — тип исключения.
- строки с "at ..." — последовательность вызовов методов, начиная с того, где произошла ошибка.
## Как читать стек трейс

1. Первая строка указывает тип ошибки.
2. Верхние строки после "at" показывают, где ошибка произошла.
3. Ищи свои классы — ошибка может возникнуть в стороннем коде, но спровоцирована из твоего.
4. Указание строки и имени файла позволяет перейти прямо в нужное место в коде.
## Пример ошибки и стек трейса

Код:
```java
public class Example {
    public static void main(String[] args) {
        String text = null;
        System.out.println(text.length());
    }
}
```

Результат:
```
Exception in thread "main" java.lang.NullPointerException
	at Example.main(Example.java:4)
```

Вывод: ошибка возникла на строке 4, в методе `main` класса `Example`.
## Как вывести стек трейс вручную

Для вывода стек трейса в консоль:
```java
try {
    // код с потенциальной ошибкой
} catch (Exception e) {
    e.printStackTrace();
}
```

Для получения стек трейса в виде строки:
```java
StringWriter sw = new StringWriter();
e.printStackTrace(new PrintWriter(sw));
String stackTrace = sw.toString();
```
## Частые исключения и их причины

|Исключение|Причина|
|---|---|
|`NullPointerException`|Использование `null` как объекта|
|`ArrayIndexOutOfBounds`|Выход за пределы массива|
|`ClassNotFoundException`|Не найден нужный класс|
|`NumberFormatException`|Ошибка преобразования строки в число|
|`IllegalArgumentException`|Метод получил недопустимый аргумент|
|`IOException`|Ошибка ввода/вывода при работе с файлами/потоками|
|`OutOfMemoryError`|Переполнение памяти, ошибка уровня `Error`|

## Использование стек трейса в разработке
- Помогает быстро находить ошибки.
- IDE позволяет по клику перейти к месту ошибки.
- В логах можно сохранять стек трейс через логгер:

```java
logger.error("Ошибка при выполнении метода", e);
```
## Рекомендации

- Всегда анализируй стек трейс при возникновении исключения.
- Используй `printStackTrace()` во время отладки, но в боевом коде лучше использовать логгеры.
- Не оставляй пустой `catch`, где ошибка просто игнорируется:

```java
catch (Exception e) {
    // плохо: ошибка проигнорирована
}
```

- Обрабатывай исключения корректно или явно прокидывай их через `throws`.

## Порядок действий при отладке
1. Прочитай тип исключения.
2. Найди первую строку, относящуюся к собственному коду.
3. Перейди к указанному файлу и строке.
4. Проанализируй, почему в этом месте могла произойти ошибка.
## Вывод

**Стек трейс** — это ключ к пониманию причины исключений в Java. Умение читать стек трейс помогает:

- быстро находить и исправлять ошибки;
- строить корректную структуру обработки исключений;
- писать устойчивый, надежный код.