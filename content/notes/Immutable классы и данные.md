---
aliases: иммутабельность, неизменность
tags: Java/ОсновыЯзыка
---
### Что такое Immutable тип данных
**Иммутабельный** (неизменяемый, immutable) класс — это класс, который после инициализации не может изменить свое состояние. То есть если в коде есть ссылка на экземпляр иммутабельного класса, то любые изменения в нем приводят к созданию нового экземпляра.
### Требования
1. **Класс должен быть объявлен как `final`**
    - Это запрещает наследование. Без этого дочерний класс может изменить поведение и нарушить неизменность.
2. **Все поля должны быть `private` и `final`**
    - `private` — для инкапсуляции.
    - `final` — чтобы поле могло быть инициализировано только один раз (в конструкторе).
3. **Не должно быть сеттеров (`set`-методов)**
    - Это предотвращает изменение состояния объекта после создания.
4. **Инициализация только через параметризованный конструктор**
    - Все значения задаются один раз при создании объекта.
5. **Если поля содержат изменяемые объекты (например, коллекции, массивы):**
    - Делайте **глубокое копирование** при присвоении и при возврате в геттерах. Это защищает от изменения содержимого коллекции извне.
6. **Методы доступа (`get`) для изменяемых объектов должны возвращать копии**
    - Например, `return new ArrayList<>(this.list)` вместо `return this.list`.

>[!Info]
>Не должно быть ссылок на изменяемые объекты

### Как объяснить это на собеседовании
**Иммутабельный класс** — это класс, который не изменяет своего состояния после создания. Он объявляется как `final`, его поля — приватные и финальные, нет сеттеров, и все поля инициализируются через конструктор. Если есть изменяемые объекты, возвращаются копии, чтобы не дать внешнему коду изменить внутреннее состояние.
### Примеры стандартных immutable-классов в Java:
|Класс|Назначение|
|---|---|
|`String`|Строки текста|
|`Integer`, `Long`, `Short`, `Byte`, `Double`, `Float`, `Character`, `Boolean`|Обёртки примитивов|
|`BigInteger`, `BigDecimal`|Высокоточные числовые значения|
|`LocalDate`, `LocalTime`, `LocalDateTime`, `OffsetDateTime`, `ZonedDateTime`|Работа с датой и временем (Java 8+)|
|`UUID`|Уникальные идентификаторы|
|`Path` (из `java.nio.file`)|Представление пути к файлу|
### Почему они immutable?
- Все поля **final** и **private**
- Нет **set**-методов
- Методы не изменяют состояние объекта, а **возвращают новый объект** при изменениях

### Дайте краткую характеристику immutable object. Зачем они нужны?

**Immutable object** — это объект, состояние которого нельзя изменить после его создания. Все поля объекта устанавливаются один раз — в момент инициализации — и больше не меняются. Такие объекты защищают данные от случайных изменений и обеспечивают стабильность в работе программы.

Они особенно полезны в многопоточной среде, так как являются по своей сути потокобезопасными: к ним можно обращаться из разных потоков без дополнительной синхронизации. Кроме того, immutable-объекты упрощают отладку, делают код более надёжным и предотвращают множество ошибок, связанных с изменением состояния.
### Как создать immutable object?

Чтобы создать immutable-класс в Java, нужно соблюдать несколько правил. Класс обычно объявляется как `final`, чтобы его нельзя было расширить и изменить поведение. Все поля должны быть `private` и `final`, а их значения передаются только через конструктор. Класс не должен содержать `set`-методов, так как они позволяют изменять состояние объекта.

Если класс содержит поля-ссылки на изменяемые объекты (например, списки, массивы), нужно обязательно делать копии этих объектов в конструкторе и в геттерах. Это нужно, чтобы внешняя логика не могла случайно изменить внутреннее состояние объекта. Такой подход гарантирует, что объект остаётся неизменным после создания.
### Какие преимущества immutable object перед обычными объектами?

Immutable-объекты обладают рядом важных преимуществ. Они **безопасны для многопоточности**, так как не требуют синхронизации. Их проще **тестировать и отлаживать**, поскольку состояние объекта не меняется — поведение предсказуемо. Они **подходят для использования в коллекциях**, особенно в качестве ключей, потому что не изменяются после помещения в `Map` или `Set`.

Также они отлично вписываются в **функциональный стиль программирования**, где вместо изменения состояния создаются новые объекты. Это делает код чище и понятнее. Благодаря всем этим качествам immutable-объекты часто применяются в Java и активно используются в стандартных библиотеках.